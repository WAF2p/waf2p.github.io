<header class="site-header">
  <div class="container header-inner">
    <a class="brand" href="{{ '/' | relative_url }}">
      <img src="{{ '/images/WAFpp_upscaled_1000.png' | relative_url }}" alt="WAF++ Logo">
      <span>{{ site.title }}</span>
    </a>

    <button class="burger" id="nav-toggle" aria-label="Menü öffnen" aria-expanded="false">
      <span></span><span></span><span></span>
    </button>

    <nav class="nav" aria-label="Hauptnavigation">
      {%- assign nav_items = site.data.navigation -%}

      {%- comment -%}
      Render normal links (non-highlight) as top-level navigation, with optional dropdowns.
      Render highlight items as CTA buttons at the end (Dokumentation).
      {%- endcomment -%}

      <div class="nav-main">
        {% for item in nav_items %}
          {% unless item.highlight %}
            {% assign is_active = false %}
            {% if page.url == item.link or (item.link != '/' and page.url contains item.link) %}
              {% assign is_active = true %}
            {% endif %}

            {% if item.children %}
              <div class="nav-group{% if is_active %} is-active{% endif %}">
                <a class="{% if is_active %}active{% endif %}" href="{{ item.link | relative_url }}">{{ item.name }}</a>
                <div class="nav-dropdown" aria-label="{{ item.name }} submenu">
                  {% for child in item.children %}
                    {% assign child_active = false %}
                    {% if page.url == child.link or (child.link != '/' and page.url contains child.link) %}
                      {% assign child_active = true %}
                    {% endif %}
                    <a class="nav-dropdown__link{% if child_active %} active{% endif %}" href="{{ child.link | relative_url }}">{{ child.name }}</a>
                  {% endfor %}
                </div>
              </div>
            {% else %}
              <a class="{% if is_active %}active{% endif %}" href="{{ item.link | relative_url }}">{{ item.name }}</a>
            {% endif %}
          {% endunless %}
        {% endfor %}
      </div>

      <div class="cta-row">
        {% for item in nav_items %}
          {% if item.highlight %}
            {% assign cta_active = false %}
            {% if page.url contains item.link %}
              {% assign cta_active = true %}
            {% endif %}
            <a class="btn btn-primary{% if cta_active %} active{% endif %}" href="{{ item.link | relative_url }}">{{ item.name }}</a>
          {% endif %}
        {% endfor %}
      </div>
    </nav>
  </div>
</header>
